<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery - Book Haven Wireframe</title>
    <link rel="stylesheet" href="css/wireframe-base.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="wireframe-nav" data-label="Main Navigation">
        <div class="wireframe-logo">LOGO</div>
        <div class="wireframe-box" data-label="Navigation Links">
            <a href="index.html" class="wireframe-text" data-width="short">Home</a>
            <a href="gallery.html" class="wireframe-text" data-width="short">Gallery</a>
            <a href="about.html" class="wireframe-text" data-width="short">About</a>
            <a href="custom.html" class="wireframe-text" data-width="short">Custom</a>
        </div>
    </nav>

    <!-- Filters -->
    <section class="wireframe-box" data-label="Filter Options">
        <div style="display: flex; gap: 1rem;">
            <div class="wireframe-input" data-label="Category">
                <select id="categoryFilter">
                    <option value="">All Categories</option>
                    <option value="fiction">Fiction</option>
                    <option value="non-fiction">Non-Fiction</option>
                </select>
            </div>
            <div class="wireframe-input" data-label="Sort">
                <select id="sortFilter">
                    <option value="price-asc">Price: Low to High</option>
                    <option value="price-desc">Price: High to Low</option>
                    <option value="name">Name</option>
                </select>
            </div>
        </div>
    </section>

    <!-- Product Grid -->
    <section class="wireframe-box" data-label="Product Gallery" id="productGrid">
        <!-- Products will be populated by JavaScript -->
    </section>

    <!-- Cart Controls -->
    <div class="wireframe-box" data-label="Cart Actions" style="position: fixed; bottom: 20px; right: 20px;">
        <button class="wireframe-button" id="viewCart">
            View Cart (<span id="cartCount">0</span>)
        </button>
        <button class="wireframe-button" id="clearCart">Clear Cart</button>
    </div>

    <!-- Include Footer Component -->
    <wireframe-footer></wireframe-footer>

    <script>
        // Cart Management with SessionStorage
        class CartManager {
            constructor() {
                this.items = JSON.parse(sessionStorage.getItem('cart') || '[]');
                this.updateUI();
                this.setupListeners();
            }

            addItem(item) {
                this.items.push(item);
                this.saveToStorage();
                this.updateUI();
                this.showNotification(`Added "${item.name}" to cart`);
            }

            removeItem(index) {
                this.items.splice(index, 1);
                this.saveToStorage();
                this.updateUI();
            }

            clearCart() {
                this.items = [];
                this.saveToStorage();
                this.updateUI();
                this.showNotification('Cart cleared');
            }

            saveToStorage() {
                sessionStorage.setItem('cart', JSON.stringify(this.items));
            }

            updateUI() {
                const cartCount = document.getElementById('cartCount');
                if (cartCount) {
                    cartCount.textContent = this.items.length;
                }
            }

            showCart() {
                const modal = new WireframeModal('cart', 'Shopping Cart');
                modal.show(this.getCartContent());
            }

            getCartContent() {
                if (this.items.length === 0) {
                    return `
                        <div class="wireframe-box" data-label="Empty Cart">
                            <p>Your cart is empty</p>
                        </div>
                    `;
                }

                return `
                    <div class="wireframe-box" data-label="Cart Items">
                        ${this.items.map((item, index) => `
                            <div class="cart-item">
                                <span>${item.name} - $${item.price}</span>
                                <button class="wireframe-button" onclick="cart.removeItem(${index})">Remove</button>
                            </div>
                        `).join('')}
                        <div class="cart-total">
                            Total: $${this.getTotal()}
                        </div>
                        <button class="wireframe-button" onclick="cart.processOrder()">Process Order</button>
                    </div>
                `;
            }

            getTotal() {
                return this.items.reduce((sum, item) => sum + item.price, 0).toFixed(2);
            }

            processOrder() {
                if (this.items.length === 0) return;

                const modal = new WireframeModal('order', 'Order Confirmation');
                modal.show(`
                    <div class="wireframe-box" data-label="Order Success">
                        <p>Order processed successfully!</p>
                        <p>Total items: ${this.items.length}</p>
                        <p>Total amount: $${this.getTotal()}</p>
                    </div>
                `);

                this.clearCart();
            }

            setupListeners() {
                document.getElementById('viewCart')?.addEventListener('click', () => this.showCart());
                document.getElementById('clearCart')?.addEventListener('click', () => this.clearCart());
            }

            showNotification(message) {
                const modal = new WireframeModal('notification', 'Notification');
                modal.show(`<p>${message}</p>`);
                setTimeout(() => modal.hide(), 2000);
            }
        }

        // Product Management
        class ProductManager {
            constructor() {
                this.products = [
                    { id: 1, name: 'Fantasy Adventure', price: 24.99, category: 'fiction' },
                    { id: 2, name: 'Science Guide', price: 29.99, category: 'non-fiction' },
                    { id: 3, name: 'Mystery Novel', price: 19.99, category: 'fiction' },
                    // Add more products as needed
                ];
                this.renderProducts();
                this.setupFilters();
            }

            renderProducts(filteredProducts = this.products) {
                const grid = document.getElementById('productGrid');
                if (!grid) return;

                grid.innerHTML = `
                    <div class="wireframe-product-grid">
                        ${filteredProducts.map(product => `
                            <div class="wireframe-product has-tooltip" data-id="${product.id}">
                                <div class="wireframe-image">Book Cover</div>
                                <div class="wireframe-text" data-width="medium">${product.name}</div>
                                <div class="wireframe-text" data-width="short">$${product.price}</div>
                                <button class="wireframe-button wireframe-add-to-cart">Add to Cart</button>
                                <div class="wireframe-tooltip">Click to add to cart</div>
                            </div>
                        `).join('')}
                    </div>
                `;

                // Add click handlers for Add to Cart buttons
                grid.querySelectorAll('.wireframe-add-to-cart').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const productId = parseInt(e.target.closest('.wireframe-product').dataset.id);
                        const product = this.products.find(p => p.id === productId);
                        if (product) {
                            cart.addItem(product);
                        }
                    });
                });
            }

            setupFilters() {
                document.getElementById('categoryFilter')?.addEventListener('change', () => this.applyFilters());
                document.getElementById('sortFilter')?.addEventListener('change', () => this.applyFilters());
            }

            applyFilters() {
                const category = document.getElementById('categoryFilter').value;
                const sort = document.getElementById('sortFilter').value;

                let filtered = this.products;
                if (category) {
                    filtered = filtered.filter(p => p.category === category);
                }

                filtered.sort((a, b) => {
                    switch (sort) {
                        case 'price-asc':
                            return a.price - b.price;
                        case 'price-desc':
                            return b.price - a.price;
                        case 'name':
                            return a.name.localeCompare(b.name);
                        default:
                            return 0;
                    }
                });

                this.renderProducts(filtered);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            window.cart = new CartManager();
            new ProductManager();
        });
    </script>

    <script src="js/components/wireframe-footer.js"></script>
</body>
</html>
